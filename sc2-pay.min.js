var sc2_pay=function(){function e(e){return e.substr(e.indexOf(" ")+1)}function a(t,r,s,i,d,l){if(n)return n=!1,void(l&&l(null));console.log("Checking Steem Transfer..."+i+", amount: "+r+" "+s),steem.api.getAccountHistory(t,-1,10,function(n,c){for(var u=!1,m=0;m<c.length;m++){var p=c[m],f=p[1].op;if(new Date(p[1].timestamp+"Z")>d&&f[1].memo==i&&"transfer"==f[0]&&f[1].to==t&&parseFloat(f[1].amount)==r&&e(f[1].amount)==s){u=!0,o&&o.modal("hide"),l&&l(p);break}}u||setTimeout(function(){a(t,r,s,i,d,l)},2e3)})}var t='<div id="sc2_pay_dialog" class="modal fade" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><span class="close" data-dismiss="modal" aria-hidden="true">X</span><h2>{sc2_pay_title}</h2></div><div class="modal-body"><iframe frameborder="0" src="{sc2_pay_url}" style="border: none;" width="500" height="560"></iframe></div></div></div></div>',o=null,n=!1;return{requestPayment:function(e,r,s,i,d,l){if("STEEM"==i||"SBD"==i){var c=sc2.sign("transfer",{to:r,amount:function(e,a,t,o){a=isNaN(a=Math.abs(a))?2:a,t=void 0==t?".":t,o=void 0==o?"":o;var n=e<0?"-":"",r=String(parseInt(e=Math.abs(Number(e)||0).toFixed(a))),s=(s=r.length)>3?s%3:0;return n+(s?r.substr(0,s)+o:"")+r.substr(s).replace(/(\d{3})(?=\d)/g,"$1"+o)+(a?t+Math.abs(e-r).toFixed(a).slice(2):"")}(s,3)+" "+i,memo:d});o=$(t.replace("{sc2_pay_title}",e).replace("{sc2_pay_url}",c)),$(document.body).append(o),o.on("hidden.bs.modal",function(){n=!0}),o.modal("show"),a(r,s,i,d,new Date,l)}else console.log('Unsupported currency "'+i+'". Supported currencies are "STEEM" or "SBD".')}}}();